here is the proposed utility code to be merged into main